<!DOCTYPE html>
<html lang=en>
<head>
	<!-- so meta -->
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="HandheldFriendly" content="True" />
	<meta
		name="viewport"
		content="width=device-width, initial-scale=1, maximum-scale=5"
	/>
	<link
		rel="stylesheet"
		type="text/css"
		href="https://fonts.font.im/css?family=Noto+Sans+SC:normal,bold,italic"
	/>
	<meta name="description" content="题目链接：https:&#x2F;&#x2F;github.com&#x2F;Airrcat&#x2F;long_long&#x2F;tree&#x2F;main&#x2F;DASCTF_2024_10 ezre查PE32位无壳 开始分析看起来很像加壳了字符串未有暴露信息，但是段中有一个themida发现是一个壳，直接去找脱壳机一些脱壳工具（Magicmida)是动态启动后脱壳，会被程序的反调试检查到后来发现了这个静态脱壳工具unlicense 1234567891">
<meta property="og:type" content="article">
<meta property="og:title" content="DASCTF 2024 10月 Reverse">
<meta property="og:url" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/index.html">
<meta property="og:site_name" content="Air_katty">
<meta property="og:description" content="题目链接：https:&#x2F;&#x2F;github.com&#x2F;Airrcat&#x2F;long_long&#x2F;tree&#x2F;main&#x2F;DASCTF_2024_10 ezre查PE32位无壳 开始分析看起来很像加壳了字符串未有暴露信息，但是段中有一个themida发现是一个壳，直接去找脱壳机一些脱壳工具（Magicmida)是动态启动后脱壳，会被程序的反调试检查到后来发现了这个静态脱壳工具unlicense 1234567891">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-10.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-11.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-12.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-13.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-14.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-15.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-16.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-17.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-18.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-19.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-22.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-21.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-23.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-24.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-25.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-26.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-27.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-28.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-29.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-30.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-31.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-38.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-37.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-32.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-33.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-39.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-40.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-41.png">
<meta property="og:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-42.png">
<meta property="article:published_time" content="2024-11-08T07:47:25.000Z">
<meta property="article:modified_time" content="2024-11-15T08:26:38.000Z">
<meta property="article:author" content="Aircat">
<meta property="article:tag" content="Reverse">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-10.png">    
	<link
		rel="shortcut icon"
		href="/images/mimi.gif"
	/>
	   
	<link
		rel="icon"
		type="image/png"
		href="/images/mimi.gif"
		sizes="192x192"
	/>
	   
	<link
		rel="apple-touch-icon"
		sizes="180x180"
		href="/images/mimi.gif"
	/>
	  
	<!-- title -->
	<title>DASCTF 2024 10月 Reverse</title>
	<!-- async scripts -->
	<!-- Google Analytics -->

 <!-- Umami Analytics -->


	<!-- styles -->
	
<link rel="stylesheet" href="/css/style.css">

	<!-- persian styles -->
	
	<!-- rss -->
	 
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="Air_katty" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/Airrcat">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="Next post" href="/2024/09/26/Error-Problem-package-iptables-legacy-in-yum-install/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/&text=DASCTF 2024 10月 Reverse"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/&title=DASCTF 2024 10月 Reverse"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/&is_video=false&description=DASCTF 2024 10月 Reverse"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=DASCTF 2024 10月 Reverse&body=Check out this article: https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/&title=DASCTF 2024 10月 Reverse"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/&title=DASCTF 2024 10月 Reverse"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/&title=DASCTF 2024 10月 Reverse"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/&title=DASCTF 2024 10月 Reverse"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/&name=DASCTF 2024 10月 Reverse&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/&t=DASCTF 2024 10月 Reverse"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ezre"><span class="toc-number">1.</span> <span class="toc-text">ezre</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ezelf"><span class="toc-number">2.</span> <span class="toc-text">ezelf</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ezAndroid"><span class="toc-number">3.</span> <span class="toc-text">ezAndroid</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        DASCTF 2024 10月 Reverse
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Aircat</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-11-08T07:47:25.000Z" class="dt-published" itemprop="datePublished">2024-11-08</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>, <a class="p-category" href="/tags/Reverse/" rel="tag">Reverse</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>题目链接：<a target="_blank" rel="noopener" href="https://github.com/Airrcat/long_long/tree/main/DASCTF_2024_10">https://github.com/Airrcat/long_long/tree/main/DASCTF_2024_10</a></p>
<h1 id="ezre"><a href="#ezre" class="headerlink" title="ezre"></a>ezre</h1><p>查PE<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-10.png" alt="alt text"><br>32位无壳</p>
<p>开始分析<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-11.png" alt="alt text"><br>看起来很像加壳了<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-12.png" alt="alt text"><br>字符串未有暴露信息，但是段中有一个themida<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-13.png" alt="alt text"><br>发现是一个壳，直接去找脱壳机<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-14.png" alt="alt text"><br>一些脱壳工具（Magicmida)是动态启动后脱壳，会被程序的反调试检查到<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-15.png" alt="alt text"><br>后来发现了这个静态脱壳工具<br><a target="_blank" rel="noopener" href="https://github.com/ergrelet/unlicense">unlicense</a><br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-16.png" alt="alt text"></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\Songs\Desktop\DASCTF10月\tempdir\REVERSE附件&gt; .\unlicense.exe <span class="string">&#x27;.\ezre.exe&#x27;</span></span><br><span class="line">INFO - Detected packer version: <span class="number">3</span>.x</span><br><span class="line">frida<span class="literal">-agent</span>: Setting up OEP tracing <span class="keyword">for</span> <span class="string">&quot;ezre.exe&quot;</span></span><br><span class="line">frida<span class="literal">-agent</span>: Exception handler registered</span><br><span class="line">frida<span class="literal">-agent</span>: OEP found (thread <span class="comment">#22604): 0x8a18fe</span></span><br><span class="line">INFO - OEP reached: OEP=<span class="number">0</span>x8a18fe BASE=<span class="number">0</span>x8a0000 DOTNET=False</span><br><span class="line">INFO - Looking <span class="keyword">for</span> the IAT...</span><br><span class="line">INFO - Performing linear scan <span class="keyword">in</span> <span class="keyword">data</span> sections...</span><br><span class="line">INFO - Looking <span class="keyword">for</span> wrapped imports <span class="keyword">in</span> code sections...</span><br><span class="line">INFO - Potential import wrappers found: <span class="number">15</span></span><br><span class="line">INFO - IAT found: <span class="number">0</span>x8a3000<span class="literal">-0x8a300b</span></span><br><span class="line">INFO - Resolving imports ...</span><br><span class="line">INFO - Imports resolved: <span class="number">43</span></span><br><span class="line">INFO - Fixed IAT at <span class="number">0</span>x8a3000, size=<span class="number">0</span>xc5</span><br><span class="line">INFO - Dumping PE with OEP=<span class="number">0</span>x8a18fe ...</span><br><span class="line">INFO - Fixing dump ...</span><br><span class="line">INFO - Rebuilding PE ...</span><br><span class="line">INFO - Output file has been saved at <span class="string">&#x27;unpacked_ezre.exe&#x27;</span></span><br></pre></td></tr></table></figure>
<p>main函数默认反编译不了，有个花<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-17.png" alt="alt text"><br>处理一下把jmp地址的e8 patch成90即可<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-18.png" alt="main"><br>上头一个cipher，底下两个处理函数然后就比较了<br>处理函数也有花，记得处理<br>第一个是魔改rc4，<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-19.png" alt="alt text"><br>重命名一下<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-22.png" alt="alt text"><br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-21.png" alt="alt text"><br>第二个是魔改xtea<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-23.png" alt="alt text"><br>要注意的是，魔改xtea在执行的时候，地址是byte +1+1并patch回去，也就是cipher的[0:4]<del>[4:8] [1:5]</del>[4~9]…<br>因此最后得倒着运算<br>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 普通的rc4解密</span></span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">key = <span class="string">&quot;th0s_i0_ke9&quot;</span></span><br><span class="line">S = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 期待输入存储字节型的列表。</span></span><br><span class="line"><span class="comment"># 预期输出存储0~256下标的列表。</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_init</span>(<span class="params">S, K</span>):  <span class="comment"># S盒初始化置换,K为密钥</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    S.clear()  <span class="comment"># init的时候重置sbox</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        S.append(i)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            j = (j + S[i] + <span class="built_in">ord</span>(K[i % <span class="built_in">len</span>(K)])) % <span class="number">256</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            j = (j + S[i] + K[i % <span class="built_in">len</span>(K)]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]  <span class="comment"># 交换S[i],S[j]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_xor</span>(<span class="params">S, D</span>):</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    result = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> D:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            k = <span class="built_in">ord</span>(a) + (S[(S[i] + S[j]) % <span class="number">256</span>] ^ <span class="number">0x33</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            k = a + (S[(S[i] + S[j]) % <span class="number">256</span>] ^ <span class="number">0x33</span>)</span><br><span class="line">        result.append(k)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_xor2</span>(<span class="params">S, D</span>):</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    result = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> D:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            k = <span class="built_in">ord</span>(a) - (S[(S[i] + S[j]) % <span class="number">256</span>] ^ <span class="number">0x33</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            k = (a - (S[(S[i] + S[j]) % <span class="number">256</span>] ^ <span class="number">0x33</span>)) &amp; <span class="number">0xff</span></span><br><span class="line">        result.append(k)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">v, key</span>):</span><br><span class="line"></span><br><span class="line">    v0, v1 = c_uint32(v[<span class="number">0</span>]), c_uint32(v[<span class="number">1</span>])</span><br><span class="line">    delta = <span class="number">0x9E3779B8</span></span><br><span class="line">    rounds = <span class="number">33</span></span><br><span class="line">    total = c_uint32(<span class="number">0x66778899</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        v0.value += (((v1.value &lt;&lt; <span class="number">5</span>) ^ (v1.value &gt;&gt; <span class="number">6</span>)) +</span><br><span class="line">                     v1.value) ^ (total.value + key[total.value &amp; <span class="number">3</span>])</span><br><span class="line">        total.value += delta</span><br><span class="line">        v1.value += (((v0.value &lt;&lt; <span class="number">4</span>) ^ (v0.value &gt;&gt; <span class="number">5</span>)) +</span><br><span class="line">                     v0.value) ^ (total.value + key[(total.value &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> v0.value, v1.value</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, key</span>):</span><br><span class="line">    v0, v1 = c_uint32(v[<span class="number">0</span>]), c_uint32(v[<span class="number">1</span>])</span><br><span class="line">    delta = <span class="number">0x9E3779B8</span></span><br><span class="line">    rounds = <span class="number">33</span></span><br><span class="line">    total = c_uint32(delta * rounds+<span class="number">0x66778899</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        v1.value -= (((v0.value &lt;&lt; <span class="number">4</span>) ^ (v0.value &gt;&gt; <span class="number">5</span>)) +</span><br><span class="line">                     v0.value) ^ (total.value + key[(total.value &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>])</span><br><span class="line">        total.value -= delta</span><br><span class="line">        v0.value -= (((v1.value &lt;&lt; <span class="number">5</span>) ^ (v1.value &gt;&gt; <span class="number">6</span>)) +</span><br><span class="line">                     v1.value) ^ (total.value + key[total.value &amp; <span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> v0.value, v1.value</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rc4_init(S, key)</span><br><span class="line">cipher = rc4_xor(S, <span class="string">&quot;12341234&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(cipher)</span><br><span class="line">value = [<span class="number">0</span>]*<span class="number">2</span></span><br><span class="line">value[<span class="number">0</span>] = <span class="built_in">int</span>.from_bytes(<span class="built_in">bytes</span>(cipher[<span class="number">0</span>:<span class="number">4</span>]), <span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">value[<span class="number">1</span>] = <span class="built_in">int</span>.from_bytes(<span class="built_in">bytes</span>(cipher[<span class="number">4</span>:<span class="number">8</span>]), <span class="string">&#x27;little&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(encrypt(value, [<span class="number">0x6e982837</span>, <span class="number">0x44332211</span>, <span class="number">0x11223344</span>, <span class="number">0x3728986e</span>]))</span><br><span class="line">cipher = decrypt([<span class="number">1690332198</span>, <span class="number">2660953638</span>], [</span><br><span class="line">    <span class="number">0x6e982837</span>, <span class="number">0x44332211</span>, <span class="number">0x11223344</span>, <span class="number">0x3728986e</span>])</span><br><span class="line">rc4_init(S, key)</span><br><span class="line">flag = rc4_xor2(S, cipher[<span class="number">0</span>].to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>) +</span><br><span class="line">                cipher[<span class="number">1</span>].to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># 标准xtea</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    cipher = <span class="string">b&#x27;P\xd4\xc8\xc4\x8f\x84@\xeb2\x81\x8f\x85l\xb2+\x06\xbf\x055].\xe3&#125;F\x8d5\x01p:\x80\x81\xc5\xe6q\xd3\xd6Pio\xe2nx\x14\xd8&#x27;</span></span><br><span class="line">    cipher = <span class="built_in">list</span>(cipher)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;cypher len:&quot;</span>, <span class="built_in">len</span>(cipher))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;cipher :<span class="subst">&#123;cipher&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="comment"># 四个key，每个是32bit，即密钥长度为128bit</span></span><br><span class="line">    tea_key = [<span class="number">0x6e982837</span>, <span class="number">0x44332211</span>, <span class="number">0x11223344</span>, <span class="number">0x3728986e</span>]</span><br><span class="line"></span><br><span class="line">    flag = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">36</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        value = [<span class="number">0</span>]*<span class="number">2</span></span><br><span class="line">        value[<span class="number">0</span>] = <span class="built_in">int</span>.from_bytes(<span class="built_in">bytes</span>(cipher[i:i+<span class="number">4</span>]), <span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">        value[<span class="number">1</span>] = <span class="built_in">int</span>.from_bytes(<span class="built_in">bytes</span>(cipher[i+<span class="number">4</span>:i+<span class="number">8</span>]), <span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">        value = decrypt(value, tea_key)</span><br><span class="line">        <span class="comment"># print(cipher)</span></span><br><span class="line">        <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            cipher[i+l] = value[<span class="number">0</span>].to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>)[l]</span><br><span class="line">            cipher[i+<span class="number">4</span>+l] = value[<span class="number">1</span>].to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>)[l]</span><br><span class="line">        <span class="comment"># print(cipher)</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;after xtea:<span class="subst">&#123;cipher&#125;</span>&quot;</span>)</span><br><span class="line">    rc4_init(S, key)</span><br><span class="line">    flag = rc4_xor2(S, cipher)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;after rc4:<span class="subst">&#123;<span class="built_in">bytes</span>(flag)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Data is :  0x12345678 0x78563412</span></span><br><span class="line"><span class="string">Encrypted data is :  0xae685ec7 0x59af4238</span></span><br><span class="line"><span class="string">Decrypted data is :  0x12345678 0x78563412</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[226, 192, 169, 129, 151, 101, 142, 195]</span><br><span class="line">(1690332198, 2660953638)</span><br><span class="line">[49, 50, 51, 52, 49, 50, 51, 52]</span><br><span class="line">cypher len: 44</span><br><span class="line">cipher :[80, 212, 200, 196, 143, 132, 64, 235, 50, 129, 143, 133, 108, 178, 43, 6, 191, 5, 53, 93, 46, 227, 125, 70, 141, 53, 1, 112, 58, 128, 129, 197, 230, 113, 211, 214, 80, 105, 111, 226, 110, 120, 20, 216]</span><br><span class="line">after xtea:[245, 207, 201, 144, 186, 121, 214, 227, 81, 34, 213, 44, 80, 233, 246, 153, 113, 77, 122, 222, 255, 68, 197, 171, 25, 55, 172, 232, 114, 182, 164, 14, 147, 134, 75, 195, 85, 54, 116, 25, 54, 162, 175, 69]</span><br><span class="line">after rc4:b<span class="string">&#x27;DASCTF&#123;Th1l_t8e1a_rc4_l8s_s8o_int9r3es4t1ng&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="ezelf"><a href="#ezelf" class="headerlink" title="ezelf"></a>ezelf</h1><p>查pe<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-24.png" alt="alt text"><br>64位<br>打开一看ollvm<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-25.png" alt="alt text"><br>试试D810<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-26.png" alt="alt text"><br>效果难以接受<br>deflat还可以，使用deflat的flat_control_flow<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-27.png" alt="alt text"><br>cipher1<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-28.png" alt="alt text"><br>cipher2<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-29.png" alt="alt text"><br>第一个加密是个rc4+xxtea<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-30.png" alt="alt text"><br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-31.png" alt="alt text"><br>这里经过deflat后代码结构可能会发生变化，比如xxtea的循环结构这里就不太对，可以参照源文件或者用ollvm解混淆的版本。<br>我大致看了下基本的结构，参数没变化，rounds16、n8.稍特别一点的是&amp;7,&amp;7这里实际应该是&amp;n，一个参考的xxtea如：<img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-38.png" alt="alt text"><br>每个n的小循环里最后一轮需要一个v[0]参数，而&amp;n能够直接在让p走一个循环，即y &#x3D; v[(p+1)&amp;n]可以在0~n内完成y从v[1]到v[n-1]后再到v[0]的变化。<br>部分变量优化后如图：<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-37.png" alt="alt text"></p>
<p>猜测是xxtea key，动调可对比<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-32.png" alt="alt text"><br>这个应该是rc4 key，盲猜<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-33.png" alt="alt text"><br>试着解一下第一个cipher，会发现xxtea能出东西，然后rc4没什么东西，实际调试发现rc4好像暂时用不到？<br>xxtea:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> dis</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MX</span>(<span class="params">z, y, total, key, p, e</span>):</span><br><span class="line">    temp1 = (z.value &gt;&gt; <span class="number">5</span> ^ y.value &lt;&lt; <span class="number">2</span>) + (y.value &gt;&gt; <span class="number">3</span> ^ z.value &lt;&lt; <span class="number">4</span>)</span><br><span class="line">    temp2 = (total.value ^ y.value) + (key[(p &amp; <span class="number">3</span>) ^ e.value] ^ z.value)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> c_uint32(temp1 ^ temp2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">n, v, key</span>):</span><br><span class="line">    delta = <span class="number">0x11451400</span></span><br><span class="line">    rounds = <span class="number">16</span></span><br><span class="line"></span><br><span class="line">    total = c_uint32(<span class="number">0</span>)</span><br><span class="line">    z = c_uint32(v[n-<span class="number">1</span>])</span><br><span class="line">    e = c_uint32(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> rounds &gt; <span class="number">0</span>:</span><br><span class="line">        total.value += delta</span><br><span class="line">        e.value = (total.value &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>):</span><br><span class="line">            y = c_uint32(v[p+<span class="number">1</span>])</span><br><span class="line">            v[p] = c_uint32(v[p] + MX(z, y, total, key, p, e).value).value</span><br><span class="line">            z.value = v[p]</span><br><span class="line">        y = c_uint32(v[<span class="number">0</span>])</span><br><span class="line">        v[n-<span class="number">1</span>] = c_uint32(v[n-<span class="number">1</span>] + MX(z, y, total, key, n-<span class="number">1</span>, e).value).value</span><br><span class="line">        z.value = v[n-<span class="number">1</span>]</span><br><span class="line">        rounds -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">n, v, key</span>):</span><br><span class="line">    delta = <span class="number">0x11451400</span></span><br><span class="line">    rounds = <span class="number">16</span></span><br><span class="line"></span><br><span class="line">    total = c_uint32(rounds * delta)</span><br><span class="line">    y = c_uint32(v[<span class="number">0</span>])</span><br><span class="line">    e = c_uint32(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> rounds &gt; <span class="number">0</span>:</span><br><span class="line">        e.value = (total.value &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">            z = c_uint32(v[p-<span class="number">1</span>])</span><br><span class="line">            v[p] = c_uint32((v[p] - MX(z, y, total, key, p, e).value)).value</span><br><span class="line">            y.value = v[p]</span><br><span class="line">        z = c_uint32(v[n-<span class="number">1</span>])</span><br><span class="line">        v[<span class="number">0</span>] = c_uint32(v[<span class="number">0</span>] - MX(z, y, total, key, <span class="number">0</span>, e).value).value</span><br><span class="line">        y.value = v[<span class="number">0</span>]</span><br><span class="line">        total.value -= delta</span><br><span class="line">        rounds -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#  test</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 该算法中每次可加密不只64bit的数据，并且加密的轮数由加密数据长度决定</span></span><br><span class="line">    cipher = <span class="string">b&#x27;\xb4\xb5ZB\xa6y\x0b\xac\x0e#x\xde\xe1-\xc6\x1d\xbb)\x8c\xe2\x94\xfe\x14\xd9\xaa\x03\xe3\x8a\x14\x92\x1cd&#x27;</span></span><br><span class="line">    <span class="comment"># cipher = b&#x27;01234567890123456790123465789012&#x27;</span></span><br><span class="line">    key = [<span class="number">0xb</span>, <span class="number">0x2d</span>, <span class="number">0xe</span>, <span class="number">0x309</span>]</span><br><span class="line">    v = [<span class="number">0</span>] * (<span class="built_in">len</span>(cipher)//<span class="number">4</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;cipher len:&quot;</span>, <span class="built_in">len</span>(cipher))</span><br><span class="line">    <span class="comment"># 密文cipher格式转化，从字节转成int</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(cipher), <span class="number">4</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;bytes&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(<span class="built_in">type</span>(cipher)):</span><br><span class="line">            v[i//<span class="number">4</span>] = <span class="built_in">int</span>.from_bytes(cipher[i:i+<span class="number">4</span>], <span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;list&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(<span class="built_in">type</span>(cipher)):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                v[i//<span class="number">4</span>] = (<span class="built_in">ord</span>(cipher[i]) | (<span class="built_in">ord</span>(cipher[i+<span class="number">1</span>]) &lt;&lt; <span class="number">8</span>) |</span><br><span class="line">                           (<span class="built_in">ord</span>(cipher[i+<span class="number">2</span>]) &lt;&lt; <span class="number">16</span>) | (<span class="built_in">ord</span>(cipher[i+<span class="number">3</span>]) &lt;&lt; <span class="number">24</span>))</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                v[i//<span class="number">4</span>] = ((cipher[i]) | ((cipher[i+<span class="number">1</span>]) &lt;&lt; <span class="number">8</span>) |</span><br><span class="line">                           ((cipher[i+<span class="number">2</span>]) &lt;&lt; <span class="number">16</span>) | ((cipher[i+<span class="number">3</span>]) &lt;&lt; <span class="number">24</span>))</span><br><span class="line"></span><br><span class="line">    k = key</span><br><span class="line">    n = <span class="built_in">len</span>(v)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> v:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(i), end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> k:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(i), end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    res = decrypt(<span class="number">8</span>, v, k)</span><br><span class="line">    flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">        flag += i.to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>之后翻到了疑似rc4加密的函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> *__fastcall <span class="title function_">sub_403A90</span><span class="params">(<span class="type">int</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> *result; <span class="comment">// rax</span></span><br><span class="line">  _QWORD v2[<span class="number">10</span>]; <span class="comment">// [rsp+0h] [rbp-B0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+54h] [rbp-5Ch]</span></span><br><span class="line">  <span class="type">int</span> *v4; <span class="comment">// [rsp+58h] [rbp-58h]</span></span><br><span class="line">  <span class="type">int</span> **v5; <span class="comment">// [rsp+60h] [rbp-50h]</span></span><br><span class="line">  <span class="type">int</span> *v6; <span class="comment">// [rsp+68h] [rbp-48h]</span></span><br><span class="line">  <span class="type">int</span> *v7; <span class="comment">// [rsp+70h] [rbp-40h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [rsp+78h] [rbp-38h]</span></span><br><span class="line">  <span class="type">bool</span> v9; <span class="comment">// [rsp+7Fh] [rbp-31h]</span></span><br><span class="line">  <span class="type">int</span> *v10; <span class="comment">// [rsp+80h] [rbp-30h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+8Ch] [rbp-24h]</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [rsp+90h] [rbp-20h]</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// [rsp+94h] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">int</span> *v14; <span class="comment">// [rsp+98h] [rbp-18h]</span></span><br><span class="line">  _DWORD v15[<span class="number">2</span>]; <span class="comment">// [rsp+A0h] [rbp-10h] BYREF</span></span><br><span class="line">  <span class="type">int</span> *v16; <span class="comment">// [rsp+A8h] [rbp-8h]</span></span><br><span class="line">  __int64 savedregs; <span class="comment">// [rsp+B0h] [rbp+0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v2[<span class="number">9</span>] = a1;</span><br><span class="line">  v5 = (<span class="type">int</span> **)&amp;v2[<span class="number">-2</span>];</span><br><span class="line">  i = <span class="number">1498122419</span>;</span><br><span class="line">  v6 = (<span class="type">int</span> *)&amp;savedregs;</span><br><span class="line">  v7 = v15;</span><br><span class="line">  v4 = a1;</span><br><span class="line">  *v5 = (<span class="type">int</span> *)v2[<span class="number">8</span>];</span><br><span class="line">  *v4 ^= pbox[<span class="number">0</span>];</span><br><span class="line">  *v7 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">-391087700</span>; ; i = <span class="number">-391087700</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = *v7;</span><br><span class="line">    v9 = v8 &lt;= <span class="number">16</span>;</span><br><span class="line">    i = <span class="number">1128705075</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v8 &gt; <span class="number">16</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v10 = v4;</span><br><span class="line">    i = <span class="number">-211233099</span>;</span><br><span class="line">    *v6 = *v4;</span><br><span class="line">    v11 = **v5;</span><br><span class="line">    v12 = dword_40A500[(<span class="type">unsigned</span> __int8)BYTE2(*v6)] + sbox[HIBYTE(*v6)];</span><br><span class="line">    v13 = dword_40A900[(<span class="type">unsigned</span> __int8)BYTE1(*v6)];</span><br><span class="line">    v14 = &amp;sbox[(<span class="type">unsigned</span> __int8)*v6 + <span class="number">768</span>];</span><br><span class="line">    i = <span class="number">822856190</span>;</span><br><span class="line">    *v4 = (*v14 + v13) ^ v12 ^ v11;</span><br><span class="line">    **v5 = *v6;</span><br><span class="line">    i = <span class="number">1380722011</span>;</span><br><span class="line">    v15[<span class="number">0</span>] = *v7 + <span class="number">1</span>;</span><br><span class="line">    *v7 = v15[<span class="number">0</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  v15[<span class="number">1</span>] = dword_40A0E4;</span><br><span class="line">  i = <span class="number">2118140716</span>;</span><br><span class="line">  **v5 ^= dword_40A0E4;</span><br><span class="line">  *v6 = *v4;</span><br><span class="line">  v16 = *v5;</span><br><span class="line">  i = <span class="number">1584127650</span>;</span><br><span class="line">  *v4 = *v16;</span><br><span class="line">  result = *v5;</span><br><span class="line">  **v5 = *v6;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其接收了前面的rc4_init吐出来的参数，但这里可以看出来并不是rc4<br>结合题目的提示，我们可以猜测是blowfish加密<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-39.png" alt="alt text"><br>这里的加密部分略微魔改<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-40.png" alt="alt text"><br>left一开始异或了pbox[0]，而在结束时不再异或pbox[N+1]，同时每一轮里不再异或pbox，等于说pbox只异或了一次，循环内全程异或sbox，约等于rc4的加密模式<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-41.png" alt="alt text"><br>这里的加密差不多是：（xl即left，这里的left、right命名参考了网上blowfish博客里的命名）<br><img src="/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/image-42.png" alt="alt text"><br>简单逆向分析一下<br>从正向来看，next_left是由left+right运算得来，而next_right存储了本轮的初始left，并不多做运算，算一个状态存储<br>即:<br>left+right-&gt;next_left<br>left-&gt;next_right<br>因此在一轮中，可以很直接从next_right得到left，进而由left+next_left求得right即：<br>next_right-&gt;left<br>next_left+left-&gt;right</p>
<p>ps:需要注意的是，encrypt最后交换了一次left和right，同时头尾还分别异或了一次pbox[0]和pbox[18]</p>
<p>算法完整实现：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">sbox = [[<span class="number">0x00000179</span>, <span class="number">0x000001BE</span>, <span class="number">0x243F6B50</span>, <span class="number">0x00000164</span>, <span class="number">0x243F6ABF</span>, <span class="number">0x243F6B94</span>, <span class="number">0x00000175</span>, <span class="number">0x243F6B20</span>, <span class="number">0x0000009A</span>, <span class="number">0x00000056</span>, <span class="number">0x243F6B1F</span>, <span class="number">0x000001E3</span>, <span class="number">0x243F6BE8</span>, <span class="number">0x243F6A16</span>, <span class="number">0x000000F7</span>, <span class="number">0x243F6B88</span>, <span class="number">0x000001BD</span>, <span class="number">0x000001BC</span>, <span class="number">0x243F6A41</span>, <span class="number">0x000000FB</span>, <span class="number">0x243F6B18</span>, <span class="number">0x243F6A04</span>, <span class="number">0x0000003D</span>, <span class="number">0x243F6B22</span>, <span class="number">0x000000F0</span>, <span class="number">0x00000042</span>, <span class="number">0x243F6BF5</span>, <span class="number">0x000000E0</span>, <span class="number">0x243F6A7F</span>, <span class="number">0x243F6A9A</span>, <span class="number">0x0000009C</span>, <span class="number">0x243F6A8C</span>, <span class="number">0x000001AD</span>, <span class="number">0x00000116</span>, <span class="number">0x243F6AF7</span>, <span class="number">0x000001C0</span>, <span class="number">0x243F6BBD</span>, <span class="number">0x243F6A2F</span>, <span class="number">0x0000016A</span>, <span class="number">0x0000079B</span>, <span class="number">0x243F6D8B</span>, <span class="number">0x000001CA</span>, <span class="number">0x000006A3</span>, <span class="number">0x243F6C37</span>, <span class="number">0x243F6A65</span>, <span class="number">0x243F6A6F</span>, <span class="number">0x0000018D</span>, <span class="number">0x00000617</span>, <span class="number">0x243F6DEA</span>, <span class="number">0x00000059</span>, <span class="number">0x000007CB</span>, <span class="number">0x243F6D22</span>, <span class="number">0x243F6B05</span>, <span class="number">0x243F6A2B</span>, <span class="number">0x0000007A</span>, <span class="number">0x00000717</span>, <span class="number">0x243F6CC1</span>, <span class="number">0x000001A2</span>, <span class="number">0x000007D3</span>, <span class="number">0x243F6D93</span>, <span class="number">0x243F6A5A</span>, <span class="number">0x243F6A5C</span>, <span class="number">0x00000041</span>, <span class="number">0x000007B6</span>, <span class="number">0x243F6D71</span>, <span class="number">0x00000139</span>, <span class="number">0x000006B7</span>, <span class="number">0x243F6D90</span>, <span class="number">0x243F6A2F</span>, <span class="number">0x243F6BF5</span>, <span class="number">0x00000026</span>, <span class="number">0x0000069D</span>, <span class="number">0x243F6D9A</span>, <span class="number">0x000001BF</span>, <span class="number">0x00000709</span>, <span class="number">0x243F6C54</span>, <span class="number">0x243F6AE9</span>, <span class="number">0x243F6BF7</span>, <span class="number">0x00000054</span>, <span class="number">0x00000752</span>, <span class="number">0x243F6C2C</span>, <span class="number">0x000000FA</span>, <span class="number">0x0000073A</span>, <span class="number">0x243F6C82</span>, <span class="number">0x243F6BB7</span>, <span class="number">0x243F6A09</span>, <span class="number">0x000000DA</span>, <span class="number">0x000007AF</span>, <span class="number">0x243F6C34</span>, <span class="number">0x000001E8</span>, <span class="number">0x000006E6</span>, <span class="number">0x243F6CCC</span>, <span class="number">0x243F6B05</span>, <span class="number">0x243F6AB7</span>, <span class="number">0x00000196</span>, <span class="number">0x00000693</span>, <span class="number">0x243F6C4D</span>, <span class="number">0x0000013B</span>, <span class="number">0x00000734</span>, <span class="number">0x243F6D31</span>, <span class="number">0x243F6B96</span>, <span class="number">0x243F6BD7</span>, <span class="number">0x00000110</span>, <span class="number">0x000007C2</span>, <span class="number">0x243F6DA1</span>, <span class="number">0x00000146</span>, <span class="number">0x00000795</span>, <span class="number">0x243F6C7A</span>, <span class="number">0x243F6A1F</span>, <span class="number">0x243F6A52</span>, <span class="number">0x00000087</span>, <span class="number">0x00000645</span>, <span class="number">0x243F6D74</span>, <span class="number">0x00000199</span>, <span class="number">0x00000707</span>, <span class="number">0x243F6C52</span>, <span class="number">0x243F6B1C</span>, <span class="number">0x243F6B6C</span>, <span class="number">0x00000138</span>, <span class="number">0x000006D7</span>, <span class="number">0x243F6D5C</span>, <span class="number">0x000000CA</span>, <span class="number">0x0000077A</span>, <span class="number">0x243F6DC3</span>, <span class="number">0x243F6A68</span>, <span class="number">0x243F6BC7</span>, <span class="number">0x0000008F</span>, <span class="number">0x000006CA</span>, <span class="number">0x243F6D11</span>, <span class="number">0x000001F2</span>, <span class="number">0x0000076E</span>, <span class="number">0x243F6CA9</span>, <span class="number">0x243F6A75</span>, <span class="number">0x243F6BC9</span>, <span class="number">0x00000135</span>, <span class="number">0x0000078A</span>, <span class="number">0x243F6D76</span>, <span class="number">0x00000013</span>, <span class="number">0x00000780</span>, <span class="number">0x243F6C46</span>, <span class="number">0x243F6BEB</span>, <span class="number">0x243F6A5B</span>, <span class="number">0x000000EB</span>, <span class="number">0x00000795</span>, <span class="number">0x243F6D4B</span>, <span class="number">0x0000004A</span>, <span class="number">0x000006C0</span>, <span class="number">0x243F6DDA</span>, <span class="number">0x243F6B71</span>, <span class="number">0x243F6A17</span>, <span class="number">0x000001E3</span>, <span class="number">0x00000667</span>, <span class="number">0x243F6C1B</span>, <span class="number">0x000000AF</span>, <span class="number">0x0000062A</span>, <span class="number">0x243F6DDE</span>, <span class="number">0x243F6B53</span>, <span class="number">0x243F6B4F</span>, <span class="number">0x0000019E</span>, <span class="number">0x00000613</span>, <span class="number">0x243F6D53</span>, <span class="number">0x000001EC</span>, <span class="number">0x0000076B</span>, <span class="number">0x243F6D78</span>, <span class="number">0x243F6B84</span>, <span class="number">0x243F6A1C</span>, <span class="number">0x00000009</span>, <span class="number">0x000006D8</span>, <span class="number">0x243F6CD1</span>, <span class="number">0x0000012B</span>, <span class="number">0x00000641</span>, <span class="number">0x243F6D10</span>, <span class="number">0x243F6A1C</span>, <span class="number">0x243F6A61</span>, <span class="number">0x00000104</span>, <span class="number">0x00000646</span>, <span class="number">0x243F6D6D</span>, <span class="number">0x0000000A</span>, <span class="number">0x0000061F</span>, <span class="number">0x243F6D92</span>, <span class="number">0x243F6A81</span>, <span class="number">0x243F6AE0</span>, <span class="number">0x0000017D</span>, <span class="number">0x00000666</span>, <span class="number">0x243F6C1D</span>, <span class="number">0x0000017B</span>, <span class="number">0x000007E6</span>, <span class="number">0x243F6C39</span>, <span class="number">0x243F6BE1</span>, <span class="number">0x243F6B23</span>, <span class="number">0x000000CA</span>, <span class="number">0x000006E5</span>, <span class="number">0x243F6D5A</span>, <span class="number">0x00000034</span>, <span class="number">0x0000079C</span>, <span class="number">0x243F6C18</span>, <span class="number">0x243F6B0F</span>, <span class="number">0x243F6AB2</span>, <span class="number">0x000000FC</span>, <span class="number">0x00000702</span>, <span class="number">0x243F6D7A</span>, <span class="number">0x0000005E</span>, <span class="number">0x000007D8</span>, <span class="number">0x243F6D9E</span>, <span class="number">0x243F6B03</span>, <span class="number">0x243F6A3A</span>, <span class="number">0x00000137</span>, <span class="number">0x00000619</span>, <span class="number">0x243F6C1C</span>, <span class="number">0x00000070</span>, <span class="number">0x0000071E</span>, <span class="number">0x243F6CB7</span>, <span class="number">0x243F6A42</span>, <span class="number">0x243F6A37</span>, <span class="number">0x00000150</span>, <span class="number">0x000007BB</span>, <span class="number">0x243F6D5A</span>, <span class="number">0x00000075</span>, <span class="number">0x0000071A</span>, <span class="number">0x243F6DCA</span>, <span class="number">0x243F6A48</span>, <span class="number">0x243F6B5B</span>, <span class="number">0x000001AA</span>, <span class="number">0x0000069C</span>, <span class="number">0x243F6D9D</span>, <span class="number">0x0000001B</span>, <span class="number">0x00000720</span>, <span class="number">0x243F6D57</span>, <span class="number">0x243F6B10</span>, <span class="number">0x243F6BE8</span>, <span class="number">0x000000FD</span>, <span class="number">0x00000656</span>, <span class="number">0x243F6CF4</span>, <span class="number">0x00000047</span>, <span class="number">0x00000686</span>, <span class="number">0x243F6C0B</span>, <span class="number">0x243F6BD9</span>, <span class="number">0x243F6BD8</span>, <span class="number">0x00000130</span>, <span class="number">0x000007DE</span>, <span class="number">0x243F6D74</span>, <span class="number">0x00000002</span>, <span class="number">0x000007F3</span>, <span class="number">0x243F6D4B</span>, <span class="number">0x243F6A41</span>, <span class="number">0x243F6B50</span>, <span class="number">0x00000033</span>, <span class="number">0x00000624</span>, <span class="number">0x243F6DC5</span>, <span class="number">0x00000133</span>, <span class="number">0x00000645</span>, <span class="number">0x243F6DCC</span>, <span class="number">0x243F6B43</span>, <span class="number">0x243F6B41</span>, <span class="number">0x000000E9</span>, <span class="number">0x00000753</span>], [<span class="number">0x243F6D0A</span>, <span class="number">0x000000D7</span>, <span class="number">0x243F6A70</span>, <span class="number">0x243F6CA6</span>, <span class="number">0x000006A7</span>, <span class="number">0x243F6B0C</span>, <span class="number">0x000001B5</span>, <span class="number">0x00000760</span>, <span class="number">0x243F6CEB</span>, <span class="number">0x000000EE</span>, <span class="number">0x243F6ADE</span>, <span class="number">0x243F6D02</span>, <span class="number">0x00000743</span>, <span class="number">0x243F6A5C</span>, <span class="number">0x000000DC</span>, <span class="number">0x000006D9</span>, <span class="number">0x243F6DC6</span>, <span class="number">0x000001DD</span>, <span class="number">0x243F6A12</span>, <span class="number">0x243F6DFF</span>, <span class="number">0x00000732</span>, <span class="number">0x243F6B80</span>, <span class="number">0x000001AC</span>, <span class="number">0x000007D5</span>, <span class="number">0x243F6D06</span>, <span class="number">0x000000C5</span>, <span class="number">0x243F6B51</span>, <span class="number">0x243F6D2B</span>, <span class="number">0x000006DC</span>, <span class="number">0x243F6A2D</span>, <span class="number">0x00000055</span>, <span class="number">0x000006FC</span>, <span class="number">0x243F6D7D</span>, <span class="number">0x000001D0</span>, <span class="number">0x243F6AA3</span>, <span class="number">0x243F6C75</span>, <span class="number">0x0000061A</span>, <span class="number">0x243F6A2A</span>, <span class="number">0x00000101</span>, <span class="number">0x000006F0</span>, <span class="number">0x243F6C4D</span>, <span class="number">0x00000138</span>, <span class="number">0x243F6A75</span>, <span class="number">0x243F6CA9</span>, <span class="number">0x000007FC</span>, <span class="number">0x243F6B27</span>, <span class="number">0x00000123</span>, <span class="number">0x000006C5</span>, <span class="number">0x243F6D32</span>, <span class="number">0x0000003B</span>, <span class="number">0x243F6A23</span>, <span class="number">0x243F6CB3</span>, <span class="number">0x00000686</span>, <span class="number">0x243F6B1A</span>, <span class="number">0x00000107</span>, <span class="number">0x00000608</span>, <span class="number">0x243F6DFD</span>, <span class="number">0x000001E8</span>, <span class="number">0x243F6BBB</span>, <span class="number">0x243F6D08</span>, <span class="number">0x0000062B</span>, <span class="number">0x243F6B94</span>, <span class="number">0x000000A1</span>, <span class="number">0x0000075A</span>, <span class="number">0x243F6CDC</span>, <span class="number">0x000000FB</span>, <span class="number">0x243F6B69</span>, <span class="number">0x243F6DD6</span>, <span class="number">0x00000655</span>, <span class="number">0x243F6ADD</span>, <span class="number">0x000000DD</span>, <span class="number">0x000007DC</span>, <span class="number">0x243F6DBD</span>, <span class="number">0x00000068</span>, <span class="number">0x243F6B0C</span>, <span class="number">0x243F6C95</span>, <span class="number">0x00000745</span>, <span class="number">0x243F6B15</span>, <span class="number">0x000001C9</span>, <span class="number">0x00000754</span>, <span class="number">0x243F6D3A</span>, <span class="number">0x0000003D</span>, <span class="number">0x243F6B34</span>, <span class="number">0x243F6DD6</span>, <span class="number">0x000006E1</span>, <span class="number">0x243F6A4E</span>, <span class="number">0x0000004E</span>, <span class="number">0x00000776</span>, <span class="number">0x243F6D6C</span>, <span class="number">0x000000F3</span>, <span class="number">0x243F6B5D</span>, <span class="number">0x243F6CEF</span>, <span class="number">0x000007F9</span>, <span class="number">0x243F6B68</span>, <span class="number">0x000001D0</span>, <span class="number">0x000007BB</span>, <span class="number">0x243F6DC9</span>, <span class="number">0x00000164</span>, <span class="number">0x243F6A2B</span>, <span class="number">0x243F6C43</span>, <span class="number">0x00000670</span>, <span class="number">0x243F6A8A</span>, <span class="number">0x0000007B</span>, <span class="number">0x000006DC</span>, <span class="number">0x243F6DAD</span>, <span class="number">0x000000FC</span>, <span class="number">0x243F6B51</span>, <span class="number">0x243F6CE4</span>, <span class="number">0x00000760</span>, <span class="number">0x243F6AF2</span>, <span class="number">0x00000004</span>, <span class="number">0x000006B5</span>, <span class="number">0x243F6D8E</span>, <span class="number">0x0000018C</span>, <span class="number">0x243F6B3C</span>, <span class="number">0x243F6D44</span>, <span class="number">0x0000071A</span>, <span class="number">0x243F6ADD</span>, <span class="number">0x0000002E</span>, <span class="number">0x0000075A</span>, <span class="number">0x243F6DCE</span>, <span class="number">0x00000120</span>, <span class="number">0x243F6BFB</span>, <span class="number">0x243F6D9F</span>, <span class="number">0x000007B1</span>, <span class="number">0x243F6BCC</span>, <span class="number">0x00000063</span>, <span class="number">0x0000068A</span>, <span class="number">0x243F6C2D</span>, <span class="number">0x00000034</span>, <span class="number">0x243F6A0C</span>, <span class="number">0x243F6D0A</span>, <span class="number">0x000006D7</span>, <span class="number">0x243F6B8B</span>, <span class="number">0x00000112</span>, <span class="number">0x000006EE</span>, <span class="number">0x243F6DF2</span>, <span class="number">0x000000AF</span>, <span class="number">0x243F6A7C</span>, <span class="number">0x243F6C01</span>, <span class="number">0x00000628</span>, <span class="number">0x243F6B11</span>, <span class="number">0x0000005D</span>, <span class="number">0x00000657</span>, <span class="number">0x243F6CE0</span>, <span class="number">0x0000008A</span>, <span class="number">0x243F6B43</span>, <span class="number">0x243F6C86</span>, <span class="number">0x00000682</span>, <span class="number">0x243F6B31</span>, <span class="number">0x0000003B</span>, <span class="number">0x000007A5</span>, <span class="number">0x243F6CF5</span>, <span class="number">0x00000058</span>, <span class="number">0x243F6B6B</span>, <span class="number">0x243F6DA1</span>, <span class="number">0x00000657</span>, <span class="number">0x243F6B40</span>, <span class="number">0x0000008E</span>, <span class="number">0x000006F1</span>, <span class="number">0x243F6C5E</span>, <span class="number">0x00000031</span>, <span class="number">0x243F6A50</span>, <span class="number">0x243F6CBD</span>, <span class="number">0x00000721</span>, <span class="number">0x243F6BF3</span>, <span class="number">0x0000019E</span>, <span class="number">0x00000766</span>, <span class="number">0x243F6C8A</span>, <span class="number">0x0000008D</span>, <span class="number">0x243F6B1B</span>, <span class="number">0x243F6C2B</span>, <span class="number">0x0000076D</span>, <span class="number">0x243F6BCA</span>, <span class="number">0x0000019D</span>, <span class="number">0x000007BD</span>, <span class="number">0x243F6C64</span>, <span class="number">0x000001F6</span>, <span class="number">0x243F6B7C</span>, <span class="number">0x243F6D1B</span>, <span class="number">0x00000735</span>, <span class="number">0x243F6BB3</span>, <span class="number">0x000000B0</span>, <span class="number">0x000006B1</span>, <span class="number">0x243F6D6A</span>, <span class="number">0x000000DD</span>, <span class="number">0x243F6BC6</span>, <span class="number">0x243F6CC0</span>, <span class="number">0x000007E2</span>, <span class="number">0x243F6A78</span>, <span class="number">0x0000004B</span>, <span class="number">0x00000639</span>, <span class="number">0x243F6D29</span>, <span class="number">0x000001DF</span>, <span class="number">0x243F6BB1</span>, <span class="number">0x243F6CD2</span>, <span class="number">0x000006E6</span>, <span class="number">0x243F6B54</span>, <span class="number">0x000001E0</span>, <span class="number">0x000007CC</span>, <span class="number">0x243F6C8D</span>, <span class="number">0x000000C7</span>, <span class="number">0x243F6B33</span>, <span class="number">0x243F6C98</span>, <span class="number">0x00000666</span>, <span class="number">0x243F6B02</span>, <span class="number">0x000001C8</span>, <span class="number">0x0000071D</span>, <span class="number">0x243F6CC3</span>, <span class="number">0x000000BF</span>, <span class="number">0x243F6AA3</span>, <span class="number">0x243F6DE8</span>, <span class="number">0x000006E9</span>, <span class="number">0x243F6BEF</span>, <span class="number">0x000000DB</span>, <span class="number">0x00000660</span>, <span class="number">0x243F6DB8</span>, <span class="number">0x000001DD</span>, <span class="number">0x243F6BD5</span>, <span class="number">0x243F6C87</span>, <span class="number">0x0000072C</span>, <span class="number">0x243F6BAA</span>, <span class="number">0x000001F5</span>, <span class="number">0x00000663</span>, <span class="number">0x243F6DB3</span>, <span class="number">0x00000069</span>, <span class="number">0x243F6A29</span>, <span class="number">0x243F6C6A</span>, <span class="number">0x000006EB</span>, <span class="number">0x243F6B17</span>, <span class="number">0x00000137</span>, <span class="number">0x0000071B</span>, <span class="number">0x243F6CF1</span>, <span class="number">0x00000193</span>, <span class="number">0x243F6A00</span>, <span class="number">0x243F6D1A</span>, <span class="number">0x000006FF</span>, <span class="number">0x243F6B0E</span>, <span class="number">0x00000021</span>, <span class="number">0x000007B1</span>, <span class="number">0x243F6D28</span>, <span class="number">0x000001BE</span>, <span class="number">0x243F6BEA</span>, <span class="number">0x243F6DB3</span>, <span class="number">0x00000787</span>, <span class="number">0x243F6B74</span>, <span class="number">0x00000104</span>, <span class="number">0x00000736</span>, <span class="number">0x243F6CBE</span>, <span class="number">0x00000089</span>, <span class="number">0x243F6A05</span>, <span class="number">0x243F6C0C</span>, <span class="number">0x000007AE</span>, <span class="number">0x243F6A08</span>, <span class="number">0x00000142</span>, <span class="number">0x000006B0</span>], [<span class="number">0x243F6DD9</span>, <span class="number">0x0000017F</span>, <span class="number">0x243F6A57</span>, <span class="number">0x0000012C</span>, <span class="number">0x243F6A21</span>, <span class="number">0x243F6B8B</span>, <span class="number">0x000000C6</span>, <span class="number">0x000018C5</span>, <span class="number">0x243F6ACE</span>, <span class="number">0x243F6C4B</span>, <span class="number">0x0000067A</span>, <span class="number">0x243F6A2B</span>, <span class="number">0x243F6F63</span>, <span class="number">0x00001C37</span>, <span class="number">0x000019D3</span>, <span class="number">0x00000114</span>, <span class="number">0x00001C6A</span>, <span class="number">0x243F73C0</span>, <span class="number">0x00001819</span>, <span class="number">0x243F740E</span>, <span class="number">0x243F7446</span>, <span class="number">0x243F73F7</span>, <span class="number">0x243F7319</span>, <span class="number">0x00000004</span>, <span class="number">0x243F683B</span>, <span class="number">0x243F7154</span>, <span class="number">0x243F6CD1</span>, <span class="number">0x00001B40</span>, <span class="number">0x000007D2</span>, <span class="number">0x00001A18</span>, <span class="number">0x243F6047</span>, <span class="number">0x000019FF</span>, <span class="number">0x243F6828</span>, <span class="number">0x0000120F</span>, <span class="number">0x243F788D</span>, <span class="number">0x00000358</span>, <span class="number">0x243F755C</span>, <span class="number">0x00001D78</span>, <span class="number">0x243F6EC0</span>, <span class="number">0x243F7510</span>, <span class="number">0x00000CB6</span>, <span class="number">0x00000259</span>, <span class="number">0x243F6AC6</span>, <span class="number">0x243F605F</span>, <span class="number">0x000010D7</span>, <span class="number">0x243F7496</span>, <span class="number">0x000006CA</span>, <span class="number">0x00001B44</span>, <span class="number">0x243F77E8</span>, <span class="number">0x243F750D</span>, <span class="number">0x00001E97</span>, <span class="number">0x243F74E5</span>, <span class="number">0x00001F57</span>, <span class="number">0x00000388</span>, <span class="number">0x000019A3</span>, <span class="number">0x243F6DF6</span>, <span class="number">0x243F74D4</span>, <span class="number">0x00000BD2</span>, <span class="number">0x243F782D</span>, <span class="number">0x00001DE7</span>, <span class="number">0x243F7596</span>, <span class="number">0x243F6E9E</span>, <span class="number">0x000005B8</span>, <span class="number">0x243F64B7</span>, <span class="number">0x243F7743</span>, <span class="number">0x243F79C4</span>, <span class="number">0x00000D70</span>, <span class="number">0x243F7230</span>, <span class="number">0x00000167</span>, <span class="number">0x00000FD2</span>, <span class="number">0x243F67CF</span>, <span class="number">0x0000028A</span>, <span class="number">0x243F6DAA</span>, <span class="number">0x00000914</span>, <span class="number">0x00000C6C</span>, <span class="number">0x000018C1</span>, <span class="number">0x243F6FD0</span>, <span class="number">0x00000D73</span>, <span class="number">0x243F7FFB</span>, <span class="number">0x000005DB</span>, <span class="number">0x243F728A</span>, <span class="number">0x0000109A</span>, <span class="number">0x243F7838</span>, <span class="number">0x243F6A4F</span>, <span class="number">0x00000590</span>, <span class="number">0x243F60EC</span>, <span class="number">0x00001ECE</span>, <span class="number">0x000018AE</span>, <span class="number">0x243F7780</span>, <span class="number">0x243F6C0D</span>, <span class="number">0x243F6944</span>, <span class="number">0x00001F7E</span>, <span class="number">0x243F6C54</span>, <span class="number">0x00001A3C</span>, <span class="number">0x243F69BD</span>, <span class="number">0x00001C8C</span>, <span class="number">0x243F6735</span>, <span class="number">0x243F6B1C</span>, <span class="number">0x00000E62</span>, <span class="number">0x243F6BAC</span>, <span class="number">0x243F77D8</span>, <span class="number">0x00000610</span>, <span class="number">0x00001C91</span>, <span class="number">0x243F72D8</span>, <span class="number">0x000002C3</span>, <span class="number">0x000006B5</span>, <span class="number">0x243F6EFD</span>, <span class="number">0x000004FA</span>, <span class="number">0x243F7964</span>, <span class="number">0x000000C1</span>, <span class="number">0x243F6B31</span>, <span class="number">0x00000FC6</span>, <span class="number">0x243F6599</span>, <span class="number">0x243F6FC0</span>, <span class="number">0x000016D1</span>, <span class="number">0x243F7E5C</span>, <span class="number">0x0000161A</span>, <span class="number">0x000001C2</span>, <span class="number">0x243F72FB</span>, <span class="number">0x00001AF6</span>, <span class="number">0x243F630A</span>, <span class="number">0x243F677E</span>, <span class="number">0x243F75A2</span>, <span class="number">0x0000008F</span>, <span class="number">0x243F612D</span>, <span class="number">0x000005C4</span>, <span class="number">0x00001739</span>, <span class="number">0x00001A95</span>, <span class="number">0x243F7163</span>, <span class="number">0x00001517</span>, <span class="number">0x243F73A9</span>, <span class="number">0x243F7B9F</span>, <span class="number">0x243F6605</span>, <span class="number">0x243F789F</span>, <span class="number">0x243F78D9</span>, <span class="number">0x243F6481</span>, <span class="number">0x00000407</span>, <span class="number">0x00001402</span>, <span class="number">0x243F76DD</span>, <span class="number">0x243F6C84</span>, <span class="number">0x243F65DE</span>, <span class="number">0x0000085E</span>, <span class="number">0x243F613E</span>, <span class="number">0x00001BE3</span>, <span class="number">0x243F6A7D</span>, <span class="number">0x000016B9</span>, <span class="number">0x00001A72</span>, <span class="number">0x243F7DE6</span>, <span class="number">0x243F6E50</span>, <span class="number">0x243F6582</span>, <span class="number">0x000001B3</span>, <span class="number">0x243F7A6A</span>, <span class="number">0x00001A0D</span>, <span class="number">0x0000195F</span>, <span class="number">0x243F6CEE</span>, <span class="number">0x243F6B4B</span>, <span class="number">0x00001517</span>, <span class="number">0x00000F71</span>, <span class="number">0x00001733</span>, <span class="number">0x00001304</span>, <span class="number">0x243F6D4A</span>, <span class="number">0x243F73EC</span>, <span class="number">0x000014C1</span>, <span class="number">0x00000D60</span>, <span class="number">0x00001A0A</span>, <span class="number">0x243F65C5</span>, <span class="number">0x243F6362</span>, <span class="number">0x000007DF</span>, <span class="number">0x0000090D</span>, <span class="number">0x000002B4</span>, <span class="number">0x243F7F3E</span>, <span class="number">0x00000E12</span>, <span class="number">0x243F7DB5</span>, <span class="number">0x243F709F</span>, <span class="number">0x243F712C</span>, <span class="number">0x243F638E</span>, <span class="number">0x243F77A0</span>, <span class="number">0x00000089</span>, <span class="number">0x243F7B1A</span>, <span class="number">0x00000763</span>, <span class="number">0x243F7C76</span>, <span class="number">0x243F6F14</span>, <span class="number">0x243F7626</span>, <span class="number">0x000009C4</span>, <span class="number">0x243F77BC</span>, <span class="number">0x243F6C86</span>, <span class="number">0x243F7FD2</span>, <span class="number">0x00000600</span>, <span class="number">0x243F76A8</span>, <span class="number">0x243F6F27</span>, <span class="number">0x0000047F</span>, <span class="number">0x000006DE</span>, <span class="number">0x243F78B8</span>, <span class="number">0x243F6DC0</span>, <span class="number">0x00001238</span>, <span class="number">0x243F7FF0</span>, <span class="number">0x243F66DE</span>, <span class="number">0x243F6E3F</span>, <span class="number">0x00000860</span>, <span class="number">0x000019ED</span>, <span class="number">0x000007B5</span>, <span class="number">0x00000C92</span>, <span class="number">0x243F70FE</span>, <span class="number">0x243F6DB7</span>, <span class="number">0x243F7049</span>, <span class="number">0x243F6BFF</span>, <span class="number">0x243F6C8F</span>, <span class="number">0x0000017F</span>, <span class="number">0x243F7510</span>, <span class="number">0x243F7C75</span>, <span class="number">0x00001AE7</span>, <span class="number">0x000015B8</span>, <span class="number">0x000009F6</span>, <span class="number">0x0000038E</span>, <span class="number">0x243F614F</span>, <span class="number">0x243F7A8B</span>, <span class="number">0x243F696F</span>, <span class="number">0x00001871</span>, <span class="number">0x243F7670</span>, <span class="number">0x243F699C</span>, <span class="number">0x243F7707</span>, <span class="number">0x243F6622</span>, <span class="number">0x243F643A</span>, <span class="number">0x000017B5</span>, <span class="number">0x0000170B</span>, <span class="number">0x00001405</span>, <span class="number">0x243F7819</span>, <span class="number">0x243F6A96</span>, <span class="number">0x243F6815</span>, <span class="number">0x00000892</span>, <span class="number">0x243F7699</span>, <span class="number">0x243F7FB6</span>, <span class="number">0x243F7F3F</span>, <span class="number">0x00000EF4</span>, <span class="number">0x243F777E</span>, <span class="number">0x000005C3</span>, <span class="number">0x0000006B</span>, <span class="number">0x00001984</span>, <span class="number">0x00001B5F</span>, <span class="number">0x000010CC</span>, <span class="number">0x00000155</span>, <span class="number">0x243F7738</span>, <span class="number">0x00001A56</span>, <span class="number">0x00000709</span>, <span class="number">0x00001DE0</span>, <span class="number">0x243F6CA6</span>, <span class="number">0x243F7F68</span>, <span class="number">0x243F7230</span>, <span class="number">0x00001280</span>, <span class="number">0x243F6E81</span>, <span class="number">0x00001078</span>, <span class="number">0x00001D32</span>, <span class="number">0x243F68BD</span>, <span class="number">0x00000818</span>, <span class="number">0x243F6311</span>, <span class="number">0x243F675C</span>], [<span class="number">0x243F78C4</span>, <span class="number">0x243F753E</span>, <span class="number">0x243F736D</span>, <span class="number">0x243F75C4</span>, <span class="number">0x243F7B49</span>, <span class="number">0x243F6182</span>, <span class="number">0x243F7736</span>, <span class="number">0x487EDA66</span>, <span class="number">0x6C41AE95</span>, <span class="number">0x00000ED2</span>, <span class="number">0x243F68E7</span>, <span class="number">0x243F51D9</span>, <span class="number">0x243F4D7E</span>, <span class="number">0x00001881</span>, <span class="number">0x487EFA5B</span>, <span class="number">0x243F50D5</span>, <span class="number">0x00003A76</span>, <span class="number">0x00004BFD</span>, <span class="number">0x000042CC</span>, <span class="number">0x243F5740</span>, <span class="number">0x4881D4F4</span>, <span class="number">0x243F3454</span>, <span class="number">0x487E9D94</span>, <span class="number">0x24C0BCA1</span>, <span class="number">0x24C0A52D</span>, <span class="number">0x6C41ECE3</span>, <span class="number">0x243FAFD6</span>, <span class="number">0x00FFCA25</span>, <span class="number">0x24C0A4AC</span>, <span class="number">0x6C418D7F</span>, <span class="number">0x0000322D</span>, <span class="number">0x24C0BC9A</span>, <span class="number">0xB4418102</span>, <span class="number">0x243F458F</span>, <span class="number">0x90FE5500</span>, <span class="number">0xFC3F4317</span>, <span class="number">0xD8003DE3</span>, <span class="number">0xD880B029</span>, <span class="number">0xD88067D2</span>, <span class="number">0xFD414299</span>, <span class="number">0x6D3F9C8A</span>, <span class="number">0x680273CD</span>, <span class="number">0x4C3D6B79</span>, <span class="number">0x907ED9F3</span>, <span class="number">0xD8005409</span>, <span class="number">0x4C3D9464</span>, <span class="number">0x04BC53DA</span>, <span class="number">0x9100426C</span>, <span class="number">0x01805807</span>, <span class="number">0x4CC294D4</span>, <span class="number">0x91FD752E</span>, <span class="number">0xB4BE1640</span>, <span class="number">0x48010E11</span>, <span class="number">0xE3032424</span>, <span class="number">0xE37C4473</span>, <span class="number">0x48012FF8</span>, <span class="number">0x48014B78</span>, <span class="number">0xE37C0627</span>, <span class="number">0x8B7EECC2</span>, <span class="number">0x6C3EE5FB</span>, <span class="number">0xFC3FB6E8</span>, <span class="number">0xAB02DFA6</span>, <span class="number">0x1E3DA9CE</span>, <span class="number">0xB3FA7DB4</span>, <span class="number">0x97C4E4E9</span>, <span class="number">0x6EBFFAE7</span>, <span class="number">0x3DBE4086</span>, <span class="number">0xDB3BD655</span>, <span class="number">0x9180AE11</span>, <span class="number">0x74402D92</span>, <span class="number">0xE4C0B226</span>, <span class="number">0x417E59CF</span>, <span class="number">0x2D3E9A98</span>, <span class="number">0x74C0161F</span>, <span class="number">0x3CBED7FF</span>, <span class="number">0x65404821</span>, <span class="number">0xBA7D1866</span>, <span class="number">0x453CFEF2</span>, <span class="number">0x4EF981B4</span>, <span class="number">0x63065FB2</span>, <span class="number">0xBBF9EB62</span>, <span class="number">0x6604C332</span>, <span class="number">0xC1409279</span>, <span class="number">0xCE3B5B30</span>, <span class="number">0xA27A27C0</span>, <span class="number">0xA402D0DB</span>, <span class="number">0xA402A165</span>, <span class="number">0x6A38B205</span>, <span class="number">0x9E4030AD</span>, <span class="number">0x8143D678</span>, <span class="number">0x81BCEF4A</span>, <span class="number">0x2A01BF61</span>, <span class="number">0xC33CB9D4</span>, <span class="number">0xA58387B8</span>, <span class="number">0xA5839152</span>, <span class="number">0x5C7FE1E9</span>, <span class="number">0x79BE6BC7</span>, <span class="number">0xD6FEA602</span>, <span class="number">0x9E80BA77</span>, <span class="number">0xD4BF5F2C</span>, <span class="number">0x7403D770</span>, <span class="number">0x63C1B0E9</span>, <span class="number">0xE683FB24</span>, <span class="number">0x8806F26D</span>, <span class="number">0x313A14C9</span>, <span class="number">0xF0FDD92D</span>, <span class="number">0x257EF53D</span>, <span class="number">0x6FFBD242</span>, <span class="number">0x93BB1CE6</span>, <span class="number">0x23F9C6D3</span>, <span class="number">0x40B9FEED</span>, <span class="number">0x247C6C25</span>, <span class="number">0xA5BE678D</span>, <span class="number">0xD1056FF7</span>, <span class="number">0x41047DD2</span>, <span class="number">0x3339C309</span>, <span class="number">0x2084BA70</span>, <span class="number">0x94B8F697</span>, <span class="number">0xBFBB7643</span>, <span class="number">0xCD40FE71</span>, <span class="number">0x18C7E438</span>, <span class="number">0x9FFA5966</span>, <span class="number">0x6DFBE110</span>, <span class="number">0xD9C73A1C</span>, <span class="number">0x8E8409F9</span>, <span class="number">0x457A62B9</span>, <span class="number">0x61BB67C5</span>, <span class="number">0xA34394F8</span>, <span class="number">0x133EC8BB</span>, <span class="number">0xD4044FDD</span>, <span class="number">0x37C2F42A</span>, <span class="number">0xD27CB5F5</span>, <span class="number">0xFA4385E6</span>, <span class="number">0xDB463532</span>, <span class="number">0xE77C83DB</span>, <span class="number">0x627AF59D</span>, <span class="number">0xB2BEF94C</span>, <span class="number">0x9538FC45</span>, <span class="number">0x94C780B8</span>, <span class="number">0xCE7D1809</span>, <span class="number">0x3600DB13</span>, <span class="number">0xD4043B07</span>, <span class="number">0x823978D3</span>, <span class="number">0xC941E157</span>, <span class="number">0xCF3B9C59</span>, <span class="number">0x1BBE0DBF</span>, <span class="number">0x45B82831</span>, <span class="number">0x2FBA2022</span>, <span class="number">0xBA404B95</span>, <span class="number">0xFBC6E8E9</span>, <span class="number">0x6BB97E01</span>, <span class="number">0xFE856CA4</span>, <span class="number">0xE0F86BE2</span>, <span class="number">0x417CFCC8</span>, <span class="number">0x593E2226</span>, <span class="number">0xCFC24E4C</span>, <span class="number">0x7A0120B8</span>, <span class="number">0x497C2328</span>, <span class="number">0xDABA34D7</span>, <span class="number">0xE4FEF97A</span>, <span class="number">0x30F9F8F0</span>, <span class="number">0xA3008CE8</span>, <span class="number">0x53042AB9</span>, <span class="number">0xDCC61F48</span>, <span class="number">0x413C8D0D</span>, <span class="number">0xF58629DF</span>, <span class="number">0xFE86F2F4</span>, <span class="number">0x9D7DC3B9</span>, <span class="number">0x78C46C05</span>, <span class="number">0x0F0042A4</span>, <span class="number">0xE0C6DC69</span>, <span class="number">0xF03965FE</span>, <span class="number">0x0D392FF5</span>, <span class="number">0x96BD28CC</span>, <span class="number">0x5007B425</span>, <span class="number">0xB23A094E</span>, <span class="number">0x78C58334</span>, <span class="number">0x554534AD</span>, <span class="number">0x76BB974C</span>, <span class="number">0xCE463A66</span>, <span class="number">0x503E5C7E</span>, <span class="number">0xECC6E9D5</span>, <span class="number">0xB2BC9A65</span>, <span class="number">0x7EFA2172</span>, <span class="number">0x9CBC1C30</span>, <span class="number">0x8ABB77E4</span>, <span class="number">0xC405B76D</span>, <span class="number">0x957E308C</span>, <span class="number">0x33C63316</span>, <span class="number">0x4538C965</span>, <span class="number">0x9E7DEEC8</span>, <span class="number">0x52429D62</span>, <span class="number">0x12477299</span>, <span class="number">0x5B06AB74</span>, <span class="number">0xE230A2BD</span>, <span class="number">0xECC0E3FC</span>, <span class="number">0x3BBB450A</span>, <span class="number">0xDD08DCAF</span>, <span class="number">0x85310C1D</span>, <span class="number">0xD6BF06E5</span>, <span class="number">0x8EFA5117</span>, <span class="number">0x008ED76D</span>, <span class="number">0xE60CBBDB</span>, <span class="number">0x153F2D29</span>, <span class="number">0x40036983</span>, <span class="number">0xCECDFD2E</span>, <span class="number">0xFBB1B2D1</span>, <span class="number">0x7545E297</span>, <span class="number">0xE8358074</span>, <span class="number">0x8DF723F0</span>, <span class="number">0xA23629D2</span>, <span class="number">0x5FCBD770</span>, <span class="number">0x94BB0B3F</span>, <span class="number">0xCC884977</span>, <span class="number">0x8DF5FC17</span>, <span class="number">0xA2F3EFA9</span>, <span class="number">0x0032BD44</span>, <span class="number">0x454EB69F</span>, <span class="number">0x52361CBE</span>, <span class="number">0x284A2C50</span>, <span class="number">0x808DB6EF</span>, <span class="number">0x100C2C87</span>, <span class="number">0xC231A257</span>, <span class="number">0xF649F162</span>, <span class="number">0x34744D4A</span>, <span class="number">0xA1C8D102</span>, <span class="number">0xA4BB9290</span>, <span class="number">0xD0889351</span>, <span class="number">0x880D0584</span>, <span class="number">0xD947E8F7</span>, <span class="number">0x6773EB5C</span>, <span class="number">0x150E2584</span>, <span class="number">0x0F75E358</span>, <span class="number">0xE5F772E0</span>, <span class="number">0x9F383204</span>, <span class="number">0x75F4A824</span>, <span class="number">0x20B41979</span>, <span class="number">0x7141F2E2</span>, <span class="number">0x2889B099</span>, <span class="number">0x3A48D877</span>, <span class="number">0x0D8FEB17</span>, <span class="number">0xBB82ED5A</span>, <span class="number">0x137E775D</span>, <span class="number">0x1489F19C</span>, <span class="number">0x1D4E3534</span>, <span class="number">0xEBF75BE4</span>, <span class="number">0x638042BA</span>, <span class="number">0x88B12A5F</span>, <span class="number">0x1B731B37</span>, <span class="number">0x7340DC9D</span>, <span class="number">0x86BF7902</span>, <span class="number">0x310D3C12</span>, <span class="number">0x00F6DEFE</span>, <span class="number">0xFF3B2E2F</span>, <span class="number">0x2748AF3A</span>, <span class="number">0xC6BE79AE</span>]</span><br><span class="line">        ]</span><br><span class="line">cipher = [<span class="number">0x8DF0B770</span>, <span class="number">0x4B1EB28E</span>, <span class="number">0x73C65C1C</span>, <span class="number">0x53DE48FD</span>,</span><br><span class="line">          <span class="number">0x982EDF34</span>, <span class="number">0xD8229123</span>, <span class="number">0x90271182</span>, <span class="number">0x1F4271E7</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(cipher), <span class="number">2</span>):</span><br><span class="line">    left = cipher[i+<span class="number">1</span>]</span><br><span class="line">    right = cipher[i] ^ <span class="number">0x243F6BA8</span></span><br><span class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        prev_left = right</span><br><span class="line">        pref_right = left ^ (sbox[<span class="number">0</span>][right &gt;&gt; <span class="number">24</span>] + sbox[<span class="number">1</span>][right &gt;&gt; <span class="number">16</span> &amp; <span class="number">0xff</span>]) ^ (</span><br><span class="line">            sbox[<span class="number">2</span>][right &gt;&gt; <span class="number">8</span> &amp; <span class="number">0xff</span>] + sbox[<span class="number">3</span>][right &amp; <span class="number">0xff</span>])</span><br><span class="line">        left = prev_left</span><br><span class="line">        right = pref_right &amp; <span class="number">0xffffffff</span></span><br><span class="line">    left ^= <span class="number">0x125</span></span><br><span class="line">    flag += left.to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>) + right.to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h1 id="ezAndroid"><a href="#ezAndroid" class="headerlink" title="ezAndroid"></a>ezAndroid</h1><p>本题的考点是会不会对luajava加密的lua文件进行解密。<br>解密的关键是分析加密函数，本题的加密落在常规的luaL_loadbufferx函数（参其它对luajava分析的文章）<br>针对本题的加密写了一个py脚本进行lua解密：<br><a target="_blank" rel="noopener" href="https://github.com/Airrcat/luajava_decode">https://github.com/Airrcat/luajava_decode</a><br>解密出来得到的是luac，可以使用unluac等软件或一些在线反编译软件进行解密，本题用<a target="_blank" rel="noopener" href="https://luadec.metaworm.site/%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%E8%A7%A3%E5%AF%86%E6%95%88%E6%9E%9C%E8%BE%83%E5%A5%BD%E3%80%82">https://luadec.metaworm.site/这个网站解密效果较好。</a><br>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">cipher = [<span class="number">863918170</span>,</span><br><span class="line">          <span class="number">366827450</span>,</span><br><span class="line">          <span class="number">2944604520</span>,</span><br><span class="line">          <span class="number">1314064158</span>,</span><br><span class="line">          <span class="number">2534040034</span>,</span><br><span class="line">          <span class="number">1250268803</span>,</span><br><span class="line">          <span class="number">3402278143</span>,</span><br><span class="line">          <span class="number">1361039932</span>,</span><br><span class="line">          <span class="number">3087907484</span>,</span><br><span class="line">          <span class="number">3107271874</span>]</span><br><span class="line">key = [</span><br><span class="line">    <span class="number">5976</span>,</span><br><span class="line">    <span class="number">40857</span>,</span><br><span class="line">    <span class="number">3298229483</span>,</span><br><span class="line">    <span class="number">1500946329</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, key</span>):</span><br><span class="line">    v0, v1 = c_uint32(v[<span class="number">0</span>] ^ <span class="number">14</span>), c_uint32(v[<span class="number">1</span>] ^ <span class="number">17</span>)</span><br><span class="line">    delta = <span class="number">0x80D6732B</span></span><br><span class="line">    rounds = <span class="number">38</span></span><br><span class="line">    total = c_uint32(delta * rounds)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        v1.value -= (((v0.value &lt;&lt; <span class="number">4</span>) ^ (v0.value &gt;&gt; <span class="number">5</span>)) +</span><br><span class="line">                     v0.value) ^ (total.value + key[(total.value &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>])</span><br><span class="line">        v0.value -= (((v1.value &lt;&lt; <span class="number">4</span>) ^ (v1.value &gt;&gt; <span class="number">5</span>)) +</span><br><span class="line">                     v1.value) ^ (total.value + key[total.value &amp; <span class="number">3</span>])</span><br><span class="line">        total.value -= delta</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> v0.value, v1.value</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 标准xtea</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    value = cipher</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;cypher len:&quot;</span>, <span class="built_in">len</span>(cipher))</span><br><span class="line"></span><br><span class="line">    flag = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(value), <span class="number">2</span>):</span><br><span class="line">        res = decrypt(value[i:i+<span class="number">2</span>], key)</span><br><span class="line">        flag += res[<span class="number">0</span>].to_bytes(<span class="number">4</span>, <span class="string">&#x27;big&#x27;</span>) + res[<span class="number">1</span>].to_bytes(<span class="number">4</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(flag, <span class="built_in">len</span>(flag))</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Data is :  0x12345678 0x78563412</span></span><br><span class="line"><span class="string">Encrypted data is :  0xae685ec7 0x59af4238</span></span><br><span class="line"><span class="string">Decrypted data is :  0x12345678 0x78563412</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/Airrcat">Projects</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ezre"><span class="toc-number">1.</span> <span class="toc-text">ezre</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ezelf"><span class="toc-number">2.</span> <span class="toc-text">ezelf</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ezAndroid"><span class="toc-number">3.</span> <span class="toc-text">ezAndroid</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/&text=DASCTF 2024 10月 Reverse"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/&title=DASCTF 2024 10月 Reverse"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/&is_video=false&description=DASCTF 2024 10月 Reverse"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=DASCTF 2024 10月 Reverse&body=Check out this article: https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/&title=DASCTF 2024 10月 Reverse"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/&title=DASCTF 2024 10月 Reverse"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/&title=DASCTF 2024 10月 Reverse"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/&title=DASCTF 2024 10月 Reverse"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/&name=DASCTF 2024 10月 Reverse&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://airrcat.github.io/2024/11/08/DASCTF-2024-10%E6%9C%88-Reverse/&t=DASCTF 2024 10月 Reverse"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2024
    Aircat
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/Airrcat">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
